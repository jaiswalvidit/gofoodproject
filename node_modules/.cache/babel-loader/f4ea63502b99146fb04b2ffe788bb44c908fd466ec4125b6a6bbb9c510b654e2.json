{"ast":null,"code":"import _regeneratorRuntime from\"D:/food_app/mernapp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/food_app/mernapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';import trash from'../assets/trash.svg';import{useCart,useDispatchCart}from'../components/ContextReducer';import{IMAGE_URL}from'../constants';import{loadStripe}from'@stripe/stripe-js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Cart(){var data=useCart();var dispatch=useDispatchCart();var userEmail=localStorage.getItem('userEmail');var body={products:data,email:userEmail,order_date:new Date().toDateString()};var handlePayment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var stripe,response,session,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return loadStripe('pk_test_51NtSqvSA9hxVLxKfUkTY1DACH1qBGcxaVJv1kwSTyfof4OlGiYkI6kcIswyhdjdAaJ4NfHlKKvgxF3QmE5mVYgWP00wdcBfQGp');case 3:stripe=_context.sent;_context.next=6;return fetch('http://localhost:5000/api/create-checkout-session',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});case 6:response=_context.sent;if(response.ok){_context.next=9;break;}throw new Error('Server response error: '+response.status);case 9:_context.next=11;return response.json();case 11:session=_context.sent;_context.next=14;return stripe.redirectToCheckout({sessionId:session.sessionId});case 14:result=_context.sent;if(!result.error){_context.next=17;break;}throw new Error('Stripe redirect error: '+result.error.message);case 17:_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](0);console.error('An error occurred during payment:',_context.t0);// Display an error message to the user or handle it as needed\ncase 22:case\"end\":return _context.stop();}},_callee,null,[[0,19]]);}));return function handlePayment(){return _ref.apply(this,arguments);};}();if(data.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"container text-center mt-5\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-danger\",children:\"Your Cart is Empty!\"})});}var totalPrice=data.reduce(function(total,food){return total+food.price*food.qty;},0);var totalItems=data.reduce(function(total,food){return total+food.qty;},0);return/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center text-primary mb-4\",children:\"Your Cart\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-hover table-striped text-center\",children:[\" \",/*#__PURE__*/_jsx(\"thead\",{className:\"bg-primary text-light fs-4\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Image\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:data.map(function(food,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:food.Name}),/*#__PURE__*/_jsx(\"td\",{children:food.qty}),/*#__PURE__*/_jsxs(\"td\",{children:[\"Rs. \",food.price*food.qty/100]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"img\",{className:\"card-img-top rounded\",src:\"\".concat(IMAGE_URL).concat(food.imageId||'defaultImageId'),alt:\"Food\",style:{height:'80px',width:'100px',objectFit:'cover'}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn p-0\",children:/*#__PURE__*/_jsx(\"img\",{src:trash,alt:\"delete\",onClick:function onClick(){return dispatch({type:'REMOVE',index:index});}})})})]},food.id);})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between fs-4 fw-bold\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{children:[\"Total Items: \",totalItems]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Total Price: Rs. \",totalPrice/100,\"/-\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-4\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success btn-lg\",onClick:handlePayment,children:\"Proceed to Checkout\"})})]});}","map":{"version":3,"names":["React","trash","useCart","useDispatchCart","IMAGE_URL","loadStripe","jsx","_jsx","jsxs","_jsxs","Cart","data","dispatch","userEmail","localStorage","getItem","body","products","email","order_date","Date","toDateString","handlePayment","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","stripe","response","session","result","wrap","_callee$","_context","prev","next","sent","fetch","method","headers","JSON","stringify","ok","Error","status","json","redirectToCheckout","sessionId","error","message","t0","console","stop","apply","arguments","length","className","children","totalPrice","reduce","total","food","price","qty","totalItems","scope","map","index","Name","src","concat","imageId","alt","style","height","width","objectFit","type","onClick","id"],"sources":["D:/food_app/mernapp/src/screens/Cart.js"],"sourcesContent":["import React from 'react';\r\nimport trash from '../assets/trash.svg';\r\nimport { useCart, useDispatchCart } from '../components/ContextReducer';\r\nimport { IMAGE_URL } from '../constants';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\n\r\nexport default function Cart() {\r\n  const data = useCart();\r\n  const dispatch = useDispatchCart();\r\n  const userEmail = localStorage.getItem('userEmail');\r\n\r\n  const body = {\r\n    products: data,\r\n    email: userEmail,\r\n    order_date: new Date().toDateString(),\r\n  };\r\n\r\n  const handlePayment = async () => {\r\n    try {\r\n      const stripe = await loadStripe(\r\n        'pk_test_51NtSqvSA9hxVLxKfUkTY1DACH1qBGcxaVJv1kwSTyfof4OlGiYkI6kcIswyhdjdAaJ4NfHlKKvgxF3QmE5mVYgWP00wdcBfQGp'\r\n      );\r\n\r\n      const response = await fetch('http://localhost:5000/api/create-checkout-session', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(body),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Server response error: ' + response.status);\r\n      }\r\n\r\n      const session = await response.json();\r\n\r\n      const result = await stripe.redirectToCheckout({\r\n        sessionId: session.sessionId,\r\n      });\r\n\r\n      if (result.error) {\r\n        throw new Error('Stripe redirect error: ' + result.error.message);\r\n      }\r\n    } catch (error) {\r\n      console.error('An error occurred during payment:', error);\r\n      // Display an error message to the user or handle it as needed\r\n    }\r\n  };\r\n\r\n  if (data.length === 0) {\r\n    return (\r\n      <div className=\"container text-center mt-5\">\r\n        <h1 className=\"text-danger\">Your Cart is Empty!</h1>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const totalPrice = data.reduce((total, food) => total + food.price * food.qty, 0);\r\n  const totalItems = data.reduce((total, food) => total + food.qty, 0);\r\n\r\n  return (\r\n    <div className=\"container mt-2\">\r\n    <h1 className=\"text-center text-primary mb-4\">Your Cart</h1>\r\n    <div className=\"table-responsive\">\r\n      <table className=\"table table-hover table-striped text-center\"> {/* Added 'text-center' class */}\r\n        <thead className=\"bg-primary text-light fs-4\">\r\n          <tr>\r\n            <th scope=\"col\">#</th>\r\n            <th scope=\"col\">Name</th>\r\n            <th scope=\"col\">Quantity</th>\r\n            <th scope=\"col\">Amount</th>\r\n            <th scope=\"col\">Image</th>\r\n            <th scope=\"col\">Action</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {data.map((food, index) => (\r\n            <tr key={food.id}>\r\n              <th scope=\"row\">{index + 1}</th>\r\n              <td>{food.Name}</td>\r\n              <td>{food.qty}</td>\r\n              <td>Rs. {(food.price * food.qty) / 100}</td>\r\n              <td>\r\n                <img\r\n                  className=\"card-img-top rounded\"\r\n                  src={`${IMAGE_URL}${food.imageId || 'defaultImageId'}`}\r\n                  alt=\"Food\"\r\n                  style={{ height: '80px', width: '100px', objectFit: 'cover' }}\r\n                />\r\n              </td>\r\n              <td>\r\n                <button type=\"button\" className=\"btn p-0\">\r\n                  <img\r\n                    src={trash}\r\n                    alt=\"delete\"\r\n                    onClick={() => dispatch({ type: 'REMOVE', index: index })}\r\n                  />\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    <div className=\"d-flex justify-content-between fs-4 fw-bold\"> {/* Added 'fw-bold' class */}\r\n      <div>Total Items: {totalItems}</div>\r\n      <div>Total Price: Rs. {totalPrice / 100}/-</div>\r\n    </div>\r\n    <div className=\"text-center mt-4\">\r\n      <button className=\"btn btn-success btn-lg\" onClick={handlePayment}>\r\n        Proceed to Checkout\r\n      </button>\r\n    </div>\r\n  </div>\r\n);\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}